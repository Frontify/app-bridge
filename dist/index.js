!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("AppBridge",[],e):"object"==typeof exports?exports.AppBridge=e():t.AppBridge=e()}(self,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};return((t,e,n)=>{var r;function o(t,e,n,r){window.top.postMessage({topic:t,token:e,data:n},(null==r?void 0:r.origin)||"*")}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return a(t,arguments,s(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,t)})(t)}function a(t,e,n){return(a=p()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.r(e),n.d(e,{createIframeAppBridge:()=>E,createNativeAppBridge:()=>B,version:()=>k}),function(t){t.CloseApp="closeApp",t.DeleteAppState="deleteAppState",t.GetAppState="getAppState",t.GetAssetById="getAssetById",t.GetProjectId="getProjectId",t.GetRefreshedThirdpartyOauth2Token="getRefreshedThirdpartyOauth2Token",t.GetThirdPartyOauth2Token="getThirdPartyOAuth2Token",t.OpenAssetChooser="openAssetChooser",t.PostExternalAsset="postExternalAsset",t.PutAppState="putAppState",t.UpdateAppState="updateAppState"}(r||(r={}));var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(o,t);var e,n,r=(e=o,n=p(),function(){var t,r=s(e);if(n){var o=s(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return i(this,t)});function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,"Call with topic ".concat(t," failed."))}return o}(c(Error));function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e="function"==typeof Map?new Map:void 0;return(h=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return v(t,arguments,m(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),w(r,t)})(t)}function v(t,e,n){return(v=b()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&w(o,n.prototype),o}).apply(null,arguments)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(o,t);var e,n,r=(e=o,n=b(),function(){var t,r=m(e);if(n){var o=m(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return y(this,t)});function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,'Timeout for call with topic "'.concat(t,'" expired. Call was aborted.'))}return o}(h(Error));function A(t,e,n){return new Promise((function(r,o){window.addEventListener("message",(function n(u){var i=u.data;i.token===e&&i.topic===t&&i.success?r(i.data||!0):o(new l(t)),window.removeEventListener("message",n)})),setTimeout((function(){o(new g(t))}),(null==n?void 0:n.timeout)||3e3)}))}function O(t,e,n,r,o,u,i){try{var c=t[u](i),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var u=t.apply(e,n);function i(t){O(u,r,o,i,c,"next",t)}function c(t){O(u,r,o,i,c,"throw",t)}i(void 0)}))}}var P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Math.random().toString(20).substr(2,t)}();const T={appState:{getAppState:function(){return o(r.GetAppState,P),A(r.GetAppState,P)},updateAppState:function(t){return S(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(r.UpdateAppState,P,{newState:t}),e.abrupt("return",A(r.UpdateAppState,P));case 2:case"end":return e.stop()}}),e)})))()},deleteAppState:function(){return S(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(r.DeleteAppState,P),t.abrupt("return",A(r.DeleteAppState,P));case 2:case"end":return t.stop()}}),t)})))()}},assets:{getAssetById:function(t){return o(r.GetAssetById,P,{assetId:t}),A(r.GetAssetById,P)},postExternalAsset:function(t){return S(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.previewUrl?1e4:3e3,o(r.PostExternalAsset,P,{asset:t}),e.abrupt("return",A(r.PostExternalAsset,P,{timeout:n}));case 3:case"end":return e.stop()}}),e)})))()}},auth:{getThirdPartyOauth2Tokens:function(){return o(r.GetThirdPartyOauth2Token,P),A(r.GetThirdPartyOauth2Token,P,{timeout:3e5})},getRefreshedThirdpartyOauth2Tokens:function(t){return o(r.GetRefreshedThirdpartyOauth2Token,P,{refreshToken:t}),A(r.GetRefreshedThirdpartyOauth2Token,P)}},context:{getProjectId:function(){return o(r.GetProjectId,P),A(r.GetProjectId,P)}},utilities:{closeApp:function(){o(r.CloseApp,P)},openAssetChooser:function(){o(r.OpenAssetChooser,P)}}};var x;function j(t,e,n,r,o,u,i){try{var c=t[u](i),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}!function(t){t.OpenModal="onOpenModal"}(x||(x={}));const R={assets:{postExternalAsset:function(t){return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.abrupt("return",{});case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function i(t){j(u,r,o,i,c,"next",t)}function c(t){j(u,r,o,i,c,"throw",t)}i(void 0)}))})();var e},getAssetById:function(t){return{foo:t}}},block:{getBlockId:function(t){var e=t.closest("div[data-block]"),n=parseInt((null==e?void 0:e.getAttribute("data-block"))||"0");if(e||n>0)return n;throw new Error("Block's parent div not found.")},getBlockSettings:function(){return new Promise((function(t){return t({})}))},updateBlockSettings:function(t){return console.log(t),new Promise((function(t){return t(!0)}))}},context:{getProjectId:function(){return Promise.resolve(window.application.config.context.project.id)}},utilities:{closeApp:function(){},openAssetChooser:function(){var t=window.application.sandbox.config.tpl.render("c-assetchooser",{});window.application.connectors.events.notify(null,x.OpenModal,{modifier:"flex",$content:t})}}};var k="1.0.37",B=function(){return R},E=function(){return T}})(0,e,t),e})()}));
//# sourceMappingURL=index.js.map