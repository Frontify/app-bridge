!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(self,(function(){return(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};return((t,e,n)=>{function r(t,e,n,r){window.top.postMessage({topic:t,token:e,data:n},(null==r?void 0:r.origin)||"*")}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t){var e="function"==typeof Map?new Map:void 0;return(i=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return c(t,arguments,s(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,t)})(t)}function c(t,e,n){return(c=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o}).apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.r(e),n.d(e,{Topic:()=>m,createIframeAppBridge:()=>G,createNativeAppBridge:()=>I,version:()=>B});var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(o,t);var e,n,r=(e=o,n=a(),function(){var t,r=s(e);if(n){var o=s(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return u(this,t)});function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,"Call with topic ".concat(t," failed."))}return o}(i(Error));function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){var e="function"==typeof Map?new Map:void 0;return(d=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return h(t,arguments,w(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,t)})(t)}function h(t,e,n){return(h=b()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&v(o,n.prototype),o}).apply(null,arguments)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m,g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(o,t);var e,n,r=(e=o,n=b(),function(){var t,r=w(e);if(n){var o=w(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return y(this,t)});function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,'Timeout for call with topic "'.concat(t,'" expired. Call was aborted.'))}return o}(d(Error));function O(t,e,n){return new Promise((function(r,o){window.addEventListener("message",(function n(u){var i=u.data;i.token===e&&i.topic===t&&i.success?r(i.data||!0):o(new p(t)),window.removeEventListener("message",n)})),setTimeout((function(){o(new g(t))}),(null==n?void 0:n.timeout)||3e3)}))}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A(t,e,n,r,o,u,i){try{var c=t[u](i),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function T(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var u=t.apply(e,n);function i(t){A(u,r,o,i,c,"next",t)}function c(t){A(u,r,o,i,c,"throw",t)}i(void 0)}))}}!function(t){t.CloseApp="closeApp",t.DeleteAppState="deleteAppState",t.GetAppState="getAppState",t.GetAssetById="getAssetById",t.GetProjectId="getProjectId",t.GetRefreshedThirdpartyOauth2Token="getRefreshedThirdpartyOauth2Token",t.GetThirdPartyOauth2Tokens="getThirdPartyOauth2Tokens",t.OpenAssetChooser="openAssetChooser",t.PostExternalAsset="postExternalAsset",t.PutAppState="putAppState"}(m||(m={}));var x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return Math.random().toString(20).substr(2,t)}();const R={appState:{getAppState:function(){return r(m.GetAppState,x),O(m.GetAppState,x)},putAppState:function(t){return T(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(m.PutAppState,x,t),e.abrupt("return",O(m.PutAppState,x));case 2:case"end":return e.stop()}}),e)})))()},deleteAppState:function(){return T(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(m.DeleteAppState,x),t.abrupt("return",O(m.DeleteAppState,x));case 2:case"end":return t.stop()}}),t)})))()}},assets:{getAssetById:function(t){return r(m.GetAssetById,x,{assetId:t}),O(m.GetAssetById,x)},postExternalAsset:function(t){return T(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.previewUrl?1e4:3e3,r(m.PostExternalAsset,x,S({},t)),e.abrupt("return",O(m.PostExternalAsset,x,{timeout:n}));case 3:case"end":return e.stop()}}),e)})))()}},auth:{getThirdPartyOauth2Tokens:function(){return r(m.GetThirdPartyOauth2Tokens,x),O(m.GetThirdPartyOauth2Tokens,x,{timeout:3e5})},getRefreshedThirdpartyOauth2Tokens:function(t){return r(m.GetRefreshedThirdpartyOauth2Token,x,{refreshToken:t}),O(m.GetRefreshedThirdpartyOauth2Token,x)}},context:{getProjectId:function(){return r(m.GetProjectId,x),O(m.GetProjectId,x)}},utilities:{closeApp:function(){r(m.CloseApp,x)},openAssetChooser:function(){r(m.OpenAssetChooser,x)}}};var k;function E(t,e,n,r,o,u,i){try{var c=t[u](i),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}!function(t){t.OpenModal="onOpenModal"}(k||(k={}));const _={assets:{postExternalAsset:function(t){return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.abrupt("return",{});case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function i(t){E(u,r,o,i,c,"next",t)}function c(t){E(u,r,o,i,c,"throw",t)}i(void 0)}))})();var e},getAssetById:function(t){return{foo:t}}},block:{getBlockId:function(t){var e=t.closest("div[data-block]"),n=parseInt((null==e?void 0:e.getAttribute("data-block"))||"0");if(e||n>0)return n;throw new Error("Block's parent div not found.")},getBlockSettings:function(){return new Promise((function(t){return t({})}))},updateBlockSettings:function(t){return console.log(t),new Promise((function(t){return t(!0)}))}},context:{getProjectId:function(){return Promise.resolve(window.application.config.context.project.id)}},utilities:{closeApp:function(){},openAssetChooser:function(){var t=window.application.sandbox.config.tpl.render("c-assetchooser",{});window.application.connectors.events.notify(null,k.OpenModal,{modifier:"flex",$content:t})}}};var B="1.0.39",I=function(){return _},G=function(){return R}})(0,e,t),e})()}));
//# sourceMappingURL=index.js.map